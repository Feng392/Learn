<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // 统计用户数据
        const input = [
            {
                username: 'zhangsan',
                starCount: 10,
                content: '嘻嘻嘻',
            },
            {
                username: 'lisi',
                starCount: 122,
                content: '嘿嘿',
            },
            {
                username: 'lisi',
                starCount: 99,
                content: '呵呵',
            },
            {
                username: 'zhangsan',
                starCount: 12,
                content: '哈哈哈',
            },
            {
                username: 'wangwu',
                starCount: 6,
                content: '嗯嗯',
            },
        ];

        const output = {
            starCount: {
                zhangsan: 22,
                lisi: 221,
                wangwu: 6,
            },
            commentCount: {
                zhangsan: 2,
                lisi: 2,
                wangwu: 1,
            },
        };

        function getTotal(input) {
            const output = {
                starCount: {},
                commentCount: {},
            }
            for (const {username, starCount, content} of input) {
                if (!output.starCount[username]) {
                    output.starCount[username] = 0;
                }
                if (!output.commentCount[username]) {
                    output.commentCount[username] = 0;
                }
                output.starCount[username] += starCount;
                output.commentCount[username]++;
            }
            return output;
        }
        console.log(getTotal(input));

        // reduce 方法
        function getTotal(input) {
            return input.reduce((prev, {username, starCount, content}) => {
                if (!prev.starCount && !prev.commentCount) {
                    prev.starCount = {};
                    prev.commentCount = {};
                }
                if (!prev.starCount[username] && !prev.commentCount[username]) {
                    prev.starCount[username] = 0;
                    prev.commentCount[username] = 0;
                }
                prev.starCount[username] += starCount;
                prev.commentCount[username]++;
                return prev;
            }, {});
        }
        console.log(getTotal(input));
    </script>
</body>

</html>